---
layout: post
title: "SSD Trim"
img: ssd.jpg
date: 2018-04-03 09:52:00
category: blog
author: ykx
description: I changed HDD into SSD last month, and Fugoes told me that the function 'Trim' can considerably effect the use of SSD.
tag: [Learning, Computer]
---

原本在机械硬盘上，写入数据时，Windows会通知硬盘先将以前的擦除，再将新的数据写入到磁盘中。而在删除数据时，Windows只会在此处做个标记，说明这里应该是没有东西了，等到真正要写入数据时再来真正删除，并且做标记这个动作会保留在磁盘缓存中，等到磁盘空闲时再执行。这样一来，磁盘需要更多的时间来执行以上操作，速度当然会慢下来。

而当Windows识别到SSD并确认SSD支持Trim后，在删除数据时，会不向硬盘通知删除指令，只使用Volume Bitmap来记住这里的数据已经删除。Volume Bitmap只是一个磁盘快照，其建立速度比直接读写硬盘去标记删除区域要快得多。然后再是写入数据的时候，由于NAND闪存保存数据是纯粹的数字形式，因此可以直接根据Volume Bitmap的情况，向快照中已删除的区块写入新的数据，而不用花时间去擦除原本的数据。TRIM指令让操作系统可以告诉固态驱动器哪些数据块是不会再使用的；否则SSD控制器不知道可以回收这些闲置数据块。TRIM指令让操作系统可以告诉固态驱动器哪些数据块是不会再使用的；否则SSD控制器不知道可以回收这些闲置数据块。这个功能一个大的特点就是：回收闲置的SSD数据块。

注意：如果SSD组RAID0后，将失去Trim功能。

### 查询Trim指令(Win)

> fsutil behavior query DisableDeleteNotify

如果提示“DisableDeleteNotify = 0”表示Trim指令已经启用，反之则未启用

### 打开Trim

> fsutil behavior set disabledeletenotify 0

改为1则表示关闭
